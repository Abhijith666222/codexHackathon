- **Scope assumption**: this is for a `codex app-server v2` client UI (IDE/desktop/web) that manages threads, turns, streaming events, and approvals.

- **Target users**
- `Primary`: individual software engineers who need fast, keyboard-driven coding help in active repos.
- `Secondary`: enterprise/team developers who need clear approval gates, auditability, and predictable safety behavior.
- `Secondary`: integration developers embedding Codex into their own client and needing debuggable protocol/state visibility.

- **Core user flows (must support end-to-end)**
- Authenticate and initialize connection, with clear state if auth is missing/expired.
- Start, resume, and fork threads from history.
- Start a turn, view streamed progress (`item/*`, deltas), steer mid-turn, and interrupt safely.
- Handle approval requests for commands/file changes inline, with accept/decline outcomes reflected in the timeline.
- Review final outputs: agent message, command results, file diffs, failures, and usage/rate-limit status.
- Recover from failures (`Not initialized`, overload/retry, network drop) without losing user input.
- Discover and invoke skills/apps/mentions from the composer.

- **Content priority order**
- Live turn status and timeline events.
- Pending approvals requiring user action.
- Final answer plus actionable artifacts (diffs, commands, logs).
- Error context with next-step guidance.
- Thread metadata and navigation (title, updated time, status, archived state).

- **Design and accessibility constraints**
- Keyboard-first interaction for all primary actions (compose, approve, interrupt, navigate threads).
- Screen reader support for streaming updates and approval prompts (ARIA live regions + meaningful labels).
- WCAG 2.2 AA contrast; never use color alone for status/severity.
- Deterministic focus management for dialogs/modals, especially approval flows.
- Motion and streaming updates must not cause focus jumps or layout thrash.
- Clear destructive/sensitive action confirmations with explicit scope (“this turn” vs “session”).
- Timestamps and status text should be human-readable and locale-safe.
- Responsive layout must preserve full functionality on narrower panes/windows.

- **Definition-of-done checklist**
- [ ] All core flows above are testable without hidden/manual recovery steps.
- [ ] A blocked approval always shows exactly what is blocked and what decision options are available.
- [ ] Any error state presents a retry/recover path.
- [ ] UI remains usable with keyboard-only and screen reader-only navigation.
- [ ] Streaming and approval events are understandable without relying on animation or color cues.